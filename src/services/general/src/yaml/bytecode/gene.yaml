gene-shimmer: |
    plot #62, #0
    const #63, [1]
    get #61, #62, #63
    const #60, [0.5]
    mul #61, #61, #60
    const #63, [0]
    get #60, #62, #63
    add #60, #60, #61
    const #62, [-3]
    add #44, #60, #62
    const #15, [183,192,200,   111,129,144,   0,153,255]
    const #16, [3]
    const #97, [0]
    get #97, #4, #97
    pick #15, #97, #15, #16
    const #5, [6]
    const #10, [1,1]
    shape #10, #1, #2, #44, #5, #15
    ; draw chevrons
    const #97, {"chevron-left"}
    const #98, [0]
    asset #90, #97, #98
    const #98, [1]
    asset #91, #97, #98
    image #90, #90, #91, #97
    const #97, {"chevron-right"}
    const #98, [0]
    asset #92, #97, #98
    const #98, [1]
    asset #91, #97, #98
    image #98, #92, #91, #97
    const #6, [0]
    const #7, [14]
    const #8, [0]
    const #100, [1]
    const #101, [0]
    const #102, [60]
    const #107, [1]
    get #107, #4, #107
    const #100, [1]
    eq #107, #107, #100
    const #100, [1]
    elide #101, #107, #100
    runs #100, #101, #102
    const #101, [50]
    mul #100, #100, #101
    const #41, [3,0, 1,1,0,1, 0,0,1,11, 3]
    shape #41, #100, #8, #60, #7, #98
    const #107, [1]
    get #107, #4, #107
    const #100, [0]
    eq #107, #107, #100
    const #101, [1]
    elide #101, #107, #101
    runs #100, #101, #102
    const #101, [50]
    mul #100, #100, #101
    shape #41, #100, #8, #60, #7, #90
    ; draw feature line
    const #45, [3,0, 0,1,0,1, 1,1,0,2, 0]
    const #12, [1.0]
    const #13, [17]
    const #14, [0]
    const #11, [173,37,0]
    const #201, {"dotted-line"}
    const #202, [0]
    asset #203, #201, #202
    const #202, [1]
    asset #204, #201, #202
    image #200, #203, #204, #201
    move #100, #1
    const #101, [2]
    eq #102, #4, #101
    const #101, [1]
    elide #100, #102, #101
    const #12, [2]
    const #14, [0]
    shape #45, #100, #12, #13, #14, #200
    move #100, #1
    add #100, #100, #2
    const #101, [2]
    eq #102, #4, #101
    const #101, [1]
    elide #100, #102, #101
    shape #45, #100, #12, #13, #14, #200
    ; track zmenu
    const #98, {"[Genes]"}
    const #99, {"genes"}
    ztmplspec #99, #98
    const #98, {"genes"}
    const #99, {"internal:track:gene"}
    ztmpl #99, #98
    const #100, [0,2, 1,2,0,0, 0,0,2,2, 3]
    const #101, [0]
    const #105, {"internal:track:gene"}
    shape #100, #101, #101, #4, #5, #105        
    ; draw track label
    const #99, {"label"}
    setpart #99
    const #20, {"Lato"}
    const #44, {"Contigs"}
    const #21, [10,0,111,129,144,255,255,255]
    text2 #12, #20, #21, #44
    plot #62, #0
    const #63, [0]
    get #60, #62, #63
    const #5, [3,0,1,1,0,1,0,0,1,0,0]
    const #6, [0]
    const #7, [2]
    const #8, [30]
    shape #5, #6, #8, #60, #7, #12

gene: |
    plot #62, #0
    const #63, [1]
    get #61, #62, #63
    const #60, [0.5]
    mul #61, #61, #60
    const #63, [0]
    get #60, #62, #63
    add #60, #60, #61
    const #62, [-2]
    add #60, #60, #62
    ; draw genes
    const #10, [1,1]
    const #15, [183,192,200,   111,129,144,   0,153,255]
    const #16, [3]
    const #97, [0]
    get #97, #4, #97
    pick #15, #97, #15, #16
    const #25, [4]
    shape #10, #1, #2, #60, #25, #15
    ; draw gene zmenus
    const #98, {"[{symbol}] [{id}] / [{strand}] [{biotype}]"}
    const #99, {"gene"}
    ztmplspec #99, #98
    const #98, {"gene"}
    ztmpl #5, #98
    const #98, {"symbol"}
    zmenu #5, #98, #3
    const #98, {"id"}
    zmenu #5, #98, #5
    const #98, {"strand"}
    zmenu #5, #98, #6
    const #98, {"biotype"}
    zmenu #5, #98, #7
    const #10, [1,2]
    shape #10, #1, #2, #60, #25, #5
    ; draw feature line
    const #45, [3,0, 0,1,0,1, 1,1,0,2, 0]
    const #12, [1.0]
    const #13, [17]
    const #14, [0]
    const #11, [173,37,0]
    const #201, {"dotted-line"}
    const #202, [0]
    asset #203, #201, #202
    const #202, [1]
    asset #204, #201, #202
    image #200, #203, #204, #201
    move #100, #1
    const #101, [2]
    eq #102, #4, #101
    const #101, [1]
    elide #100, #102, #101
    const #12, [2]
    const #14, [0]
    shape #45, #100, #12, #13, #14, #200
    move #100, #1
    add #100, #100, #2
    const #101, [2]
    eq #102, #4, #101
    const #101, [1]
    elide #100, #102, #101
    shape #45, #100, #12, #13, #14, #200
    ; draw chevrons
    const #97, {"chevron-left"}
    const #98, [0]
    asset #90, #97, #98
    const #98, [1]
    asset #91, #97, #98
    image #90, #90, #91, #97
    const #97, {"chevron-right"}
    const #98, [0]
    asset #92, #97, #98
    const #98, [1]
    asset #91, #97, #98
    image #98, #92, #91, #97
    const #6, [0]
    const #7, [14]
    const #8, [0]
    const #100, [1]
    const #101, [0]
    const #102, [60]
    const #107, [1]
    get #107, #4, #107
    const #100, [1]
    eq #107, #107, #100
    const #100, [1]
    elide #101, #107, #100
    runs #100, #101, #102
    const #101, [50]
    mul #100, #100, #101
    const #41, [3,0, 1,1,0,1, 0,0,1,11, 3]
    shape #41, #100, #8, #60, #7, #98
    const #107, [1]
    get #107, #4, #107
    const #100, [0]
    eq #107, #107, #100
    const #101, [1]
    elide #101, #107, #101
    runs #100, #101, #102
    const #101, [50]
    mul #100, #100, #101
    shape #41, #100, #8, #60, #7, #90
    ; draw gene names
    const #99, {"names"}
    setpart #99
    const #20, {"Lato"}
    const #21, [10,0,111,129,144,255,255,255]
    text2 #40, #20, #21, #3
    const #41, [3,0, 0,1,0,1, 0,0,1,0, 0]
    const #6, [0]
    const #7, [14]
    const #8, [0]
    shape #41, #1, #8, #60, #7, #40
    ; draw track label
    const #99, {"label"}
    setpart #99
    const #20, {"Lato"}
    const #44, {"Genes"}
    const #21, [10,0,111,129,144,255,255,255]
    text2 #12, #20, #21, #44
    plot #62, #0
    const #63, [0]
    get #60, #62, #63
    const #25, [3,0,1,1,0,1,0,0,1,0,0]
    const #6, [0]
    const #7, [2]
    const #8, [30]
    shape #25, #6, #8, #60, #7, #12

transcript: |
    plot #62, #0
    const #63, [1]
    get #61, #62, #63
    const #60, [0.5]
    mul #61, #61, #60
    const #63, [0]
    get #60, #62, #63
    add #60, #60, #61
    const #62, [0]
    add #60, #60, #62
    ; draw feature line
    const #45, [3,0, 0,1,0,1, 1,1,0,2, 0]
    const #12, [1.0]
    const #13, [17]
    const #14, [0]
    const #11, [173,37,0]
    const #201, {"dotted-line"}
    const #202, [0]
    asset #203, #201, #202
    const #202, [1]
    asset #204, #201, #202
    image #200, #203, #204, #201
    move #100, #1
    const #101, [2]
    eq #102, #8, #101
    const #101, [1]
    elide #100, #102, #101
    const #12, [2]
    const #14, [0]
    shape #45, #100, #12, #13, #14, #200
    move #100, #1
    add #100, #100, #9
    const #101, [2]
    eq #102, #8, #101
    const #101, [1]
    elide #100, #102, #101
    shape #45, #100, #12, #13, #14, #200
    ; draw chevrons
    const #97, {"chevron-left"}
    const #98, [0]
    asset #90, #97, #98
    const #98, [1]
    asset #91, #97, #98
    image #90, #90, #91, #97
    const #97, {"chevron-right"}
    const #98, [0]
    asset #92, #97, #98
    const #98, [1]
    asset #91, #97, #98
    image #98, #92, #91, #97
    const #116, [0]
    const #117, [14]
    const #118, [0]
    const #100, [1]
    const #101, [0]
    const #102, [60]
    const #107, [1]
    get #107, #8, #107
    const #100, [1]
    eq #107, #107, #100
    const #100, [1]
    elide #101, #107, #100
    runs #100, #101, #102
    const #101, [50]
    mul #100, #100, #101
    const #41, [3,0, 1,1,0,1, 0,0,1,11, 3]
    shape #41, #100, #118, #60, #117, #98
    const #107, [1]
    get #107, #8, #107
    const #100, [0]
    eq #107, #107, #100
    const #101, [1]
    elide #101, #107, #101
    runs #100, #101, #102
    const #101, [50]
    mul #100, #100, #101
    shape #41, #100, #118, #60, #117, #90
    ; y-position
    runsof #30, #2, #1
    merge #31, #3, #4, #5, #6
    accn #12, #31, #2
    add #13, #30, #12
    const #14, [-1]
    mul #14, #31, #14
    add #14, #13, #14
    ; draw gene zmenus
    const #98, {"[{symbol}]"}
    const #99, {"gene"}
    ztmplspec #99, #98
    const #98, {"gene"}
    ztmpl #7, #98
    const #98, {"symbol"}
    zmenu #7, #98, #7
    const #10, [1,2]
    const #97, [7]
    shape #10, #1, #9, #60, #97, #7
    ; extract + draw
    ; (colour)
    const #15, [183,192,200,   111,129,144,   0,153,255]
    const #16, [3]
    const #100, [0]
    get #100, #8, #100
    pick #15, #100, #15, #16
    ; *** utr ***
    const #30, [2,1]
    move #12, #60
    const #17, [-4]
    add #12, #12, #17
    const #13, [7]
    const #16, [0]
    eq #16, #3, #16
    move #29, #14
    const #17, [1]
    elide #29, #16, #17
    move #10, #31
    elide #10, #16, #17
    shape #30, #29, #10, #12, #13, #15
    ; *** exon ***
    const #30, [1,1]
    const #16, [1]
    eq #16, #3, #16
    move #29, #14
    const #17, [1]
    elide #29, #16, #17
    move #10, #31
    elide #10, #16, #17
    shape #30, #29, #10, #12, #13, #15
    ; *** intron ***
    const #30, [1,1]
    const #16, [2]
    move #12, #60
    const #17, [-1]
    add #12, #12, #17
    const #13, [1]
    eq #16, #3, #16
    move #29, #14
    const #17, [1]
    elide #29, #16, #17
    move #10, #31
    elide #10, #16, #17
    shape #30, #29, #10, #12, #13, #15
    ; transcript label
    const #99, {"names"}
    setpart #99
    const #20, {"Lato"}
    const #21, [10,0,96,96,96,255,255,255]
    text2 #40, #20, #21, #7
    const #41, [3,0, 0,1,0,1, 0,0,1,0, 0]
    const #47, [14]
    const #48, [0]
    shape #41, #1, #48, #60, #47, #40        
    ; draw track label
    const #99, {"label"}
    setpart #99
    const #20, {"Lato"}
    const #44, {"Transcripts"}
    const #21, [10,0,111,129,144,255,255,255]
    text2 #12, #20, #21, #44
    plot #62, #0
    const #63, [0]
    get #60, #62, #63
    const #5, [3,0,1,1,0,1,0,0,1,0,0]
    const #6, [0]
    const #29, [2]
    const #10, [30]
    shape #5, #6, #10, #60, #29, #12

gene-empty-box: |
    plot #62, #0
    const #63, [1]
    get #61, #62, #63
    const #60, [0.5]
    mul #61, #61, #60
    const #63, [0]
    get #60, #62, #63
    add #60, #60, #61
    const #62, [-3]
    add #60, #60, #62
    ; y-position
    ; see previous scale for details in comments.
    ; register usage essentially same.
    ; draw feature line
    const #45, [3,0, 0,1,0,1, 1,1,0,2, 0]
    const #12, [1.0]
    const #13, [17]
    const #14, [0]
    const #11, [173,37,0]
    const #201, {"dotted-line"}
    const #202, [0]
    asset #203, #201, #202
    const #202, [1]
    asset #204, #201, #202
    image #200, #203, #204, #201
    move #100, #1
    const #101, [2]
    eq #102, #8, #101
    const #101, [1]
    elide #100, #102, #101
    const #12, [2]
    const #14, [0]
    shape #45, #100, #12, #13, #14, #200
    move #100, #1
    add #100, #100, #9
    const #101, [2]
    eq #102, #8, #101
    const #101, [1]
    elide #100, #102, #101
    shape #45, #100, #12, #13, #14, #200
    ; We also use #9, as tmp and reuse #1,#2 as tmp.
    runsof #10, #2, #1
    merge #11, #3, #4, #5, #6
    accn #12, #11, #2
    add #13, #10, #12
    const #14, [-1]
    mul #14, #11, #14
    add #14, #13, #14
    ; draw gene zmenus
    const #98, {"[{symbol}]"}
    const #99, {"gene"}
    ztmplspec #99, #98
    const #98, {"gene"}
    ztmpl #7, #98
    const #98, {"symbol"}
    zmenu #7, #98, #7
    const #10, [1,2]
    const #97, [7]
    shape #10, #1, #9, #60, #97, #7
    ; *** utrs and introns ***
    const #15, [75,168,252]
    const #15, [212,217,222,   157,169,180, 112,198,255]
    const #16, [3]
    const #100, [0]
    get #100, #8, #100        
    pick #15, #100, #15, #16
    const #10, [2,1]
    move #12, #60
    const #13, [6]
    const #16, [0]
    eq #29, #3, #16
    const #16, [2]
    eq #16, #3, #16
    or #16, #16, #29
    move #7, #14
    const #17, [1]
    elide #7, #16, #17
    move #88, #11
    elide #88, #16, #17
    runs #29, #7, #88
    const #1, [-0.45]
    add #29, #29, #1
    const #2, [0.9]
    shape #10, #29, #2, #12, #13, #15
    ; *** exons ***
    const #15, [183,192,200,   111,129,144,  0,153,255]
    const #16, [3]
    const #100, [0]
    get #100, #8, #100
    pick #15, #100, #15, #16
    const #10, [1,1]
    const #16, [1]
    eq #16, #3, #16
    move #7, #14
    const #17, [1]
    elide #7, #16, #17
    move #8, #11
    elide #8, #16, #17
    runs #29, #7, #8
    const #1, [-0.45]
    add #29, #29, #1
    const #2, [0.9]
    shape #10, #29, #2, #12, #13, #15
    ; draw track label
    const #99, {"label"}
    setpart #99
    const #20, {"Lato"}
    const #44, {"Transcripts and Sequence"}
    const #21, [10,0,111,129,144,255,255,255]
    text2 #12, #20, #21, #44
    plot #62, #0
    const #63, [0]
    get #60, #62, #63
    const #5, [3,0,1,1,0,1,0,0,1,0,0]
    const #6, [0]
    const #7, [2]
    const #8, [30]
    shape #5, #6, #8, #60, #7, #12

gene-letterbox: |
    const #17, [
         12, 24, 24, 24, 24, 24, 24, 24, 24, 24
    ]
    scale #18
    const #19, [-16]
    add #18, #18, #19
    get #53, #17, #18
    plot #62, #0
    const #63, [1]
    get #61, #62, #63
    const #60, [0.5]
    mul #61, #61, #60
    const #63, [0]
    get #60, #62, #63
    add #60, #60, #61
    const #22, [-0.5]
    mul #62, #53, #22
    add #22, #60, #62
    ; draw feature line
    const #45, [3,0, 0,1,0,1, 1,1,0,2, 0]
    const #112, [1.0]
    const #113, [17]
    const #114, [0]
    const #201, {"dotted-line"}
    const #202, [0]
    asset #203, #201, #202
    const #202, [1]
    asset #204, #201, #202
    image #200, #203, #204, #201
    move #100, #1
    const #101, [2]
    eq #102, #8, #101
    const #101, [1]
    elide #100, #102, #101
    const #12, [2]
    const #14, [0]
    shape #45, #100, #112, #113, #114, #200
    move #100, #1
    add #100, #100, #9
    const #101, [2]
    eq #102, #8, #101
    const #101, [1]
    elide #100, #102, #101
    shape #45, #100, #112, #113, #114, #200
    ; *** scale (for size) ***
    ; decode necklaces
    runsof #30, #2, #1
    merge #31, #3, #4, #5, #6
    accn #14, #31, #2
    add #20, #30, #14
    const #14, [-1]
    mul #14, #31, #14
    add #14, #20, #14
    ; colours: a. boxes
    const #15, [183,192,200,   111,129,144,   0,153,255]
    const #16, [3]
    const #100, [0]
    get #100, #8, #100        
    pick #15, #100, #15, #16
    ; b. exon text
    const #41, [12,1,255,255,255,183,192,200,
                12,1,255,255,255,111,129,144,
                12,1,255,255,255,0,153,255]
    const #16, [8]
    pick #41, #8, #41, #16
    ; c. intron/utr text
    const #42, [12,1,183,192,200,255,255,255,
                12,1,111,129,144,255,255,255,
                12,1,0,153,255,255,255,255]
    const #16, [8]
    const #100, [0]
    get #100, #8, #100        
    pick #42, #100, #42, #16        
    ; draw gene zmenus
    const #98, {"[{symbol}]"}
    const #99, {"gene"}
    ztmplspec #99, #98
    const #98, {"gene"}
    ztmpl #7, #98
    const #98, {"symbol"}
    zmenu #7, #98, #7
    const #200, [1,2]
    const #97, [7]
    shape #200, #1, #9, #60, #97, #7
    ; *** utrs and introns ***
    const #30, [2,1]
    const #16, [0]
    eq #20, #3, #16
    const #16, [2]
    eq #16, #3, #16
    or #16, #16, #20
    move #18, #14
    const #17, [1]
    elide #18, #16, #17
    move #19, #31
    elide #19, #16, #17
    runs #20, #18, #19
    const #1, [-0.45]
    add #20, #20, #1
    move #36, #20
    const #2, [0.9]
    shape #30, #20, #2, #22, #53, #15
    ; *** exons ***
    const #30, [1,1]
    const #16, [1]
    eq #16, #3, #16
    move #18, #14
    const #17, [1]
    elide #18, #16, #17
    move #19, #31
    elide #19, #16, #17
    runs #20, #18, #19
    const #1, [-0.45]
    add #20, #20, #1
    move #35, #20
    const #2, [0.9]
    shape #30, #20, #2, #22, #53, #15
    ; *** exon text ***
    const #27, {"A","C","G","T","N"}
    const #40, {"Lato"}
    text2 #29, #40, #41, #27
    lengths #12,#10
    burst #10,#10
    index #57, #10, #27
    const #30, [1]
    pick #29, #57, #29, #30
    const #31, [3,0,0,1,0,1,1,0,1,0,0]
    runs #27, #11, #12
    member #34, #27, #35
    elide #27, #34, #30
    elide #29, #34, #30
    move #33, #22
    const #50, [0.5]
    mul #63, #53, #50
    const #50, [2]
    add #63, #63, #50
    add #33, #33, #63
    const #64, [0]
    shape #31, #27, #64, #33, #64, #29
    ; *** intron text ***
    const #27, {"A","C","G","T","N"}
    const #40, {"Lato"}
    text2 #29, #40, #42, #27
    index #57, #10, #27
    const #30, [1]
    pick #29, #57, #29, #30
    const #31, [3,0,0,1,0,1,1,0,1,0,0]
    runs #27, #11, #12
    member #34, #27, #36
    elide #27, #34, #30
    elide #29, #34, #30
    move #33, #22
    const #50, [0.5]
    mul #63, #53, #50
    const #50, [2]
    add #63, #63, #50
    add #33, #33, #63
    const #64, [0]
    shape #31, #27, #64, #33, #64, #29
    ; draw track label
    const #99, {"label"}
    setpart #99
    const #20, {"Lato"}
    const #44, {"Transcripts and Sequence"}
    const #21, [10,0,111,129,144,255,255,255]
    text2 #22, #20, #21, #44
    plot #62, #0
    const #63, [0]
    get #60, #62, #63
    const #5, [3,0,1,1,0,1,0,0,1,0,0]
    const #6, [0]
    const #7, [2]
    const #8, [30]
    shape #5, #6, #8, #60, #7, #22
