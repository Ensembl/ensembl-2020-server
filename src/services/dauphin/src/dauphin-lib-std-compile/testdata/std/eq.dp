import "lib:std";
use "std";

struct A { x: vec(number), y: vec(number) };

a := [1,2,3];
b := [4,5,6];
alienate(b);
alienate(b[]);
assert(a[]==b[],false);

assert(3==3,true);
assert(3==4,false);
assert([1]==[1],true);
assert([1]==[2],false);
assert([[1,2],[3,4]]==[[1,2],[3,4]],true);
assert([[1,2],[3,4]][]==[[1,2],[3,4]][],[true,true][]);
assert([[1,2],[3,4]][]==[[1,2],[3,4]][],true);
assert([[1,2],[3,4]][]==[[1,2],[3,5]][],[true,false][]);
assert([[1,2],[3,4]][]==[[1],[3,5]][],false);

x := [[1,2],[3,4]];
y := x;
assert(x==[[1,2],[0,0]],false);
assert(x==y,true);
x[@==1] := [0,0];
assert(x==[[1,2],[0,0]],true);
assert(x==x,true);
assert(x==y,false);

z := [[[1,2,3],[4,5,6]],
      [[0,0,0]],
      [[7,7,7],[5,5,5],[6,6,6]]];
assert(z==z,true);
assert(z[@==1]==[[0,0,0]],true);
assert(z[@==1]==[[6,6,6]],false);
assert(z[@==2][@==2]==[6,6,6],true);

z2 := [[[1,2,3],[4,5,6]],
      [[0,0,0]],
      [[1,2],[0,0]]];
alienate(z2);
assert(z==z2,false);
z[@==2] := x;
assert(z==z2,true);

a := A { x: [1,2,3], y: [4,5,6] };
b := A { x: [1,2,3], y: [4,5,6] };
c := A { x: [0,0,0], y: [4,5,6] };
d := A { x: [1,2,3], y: [0,0,0] };
assert(a.x==[1,2,3],true);
assert(a==b,true);
assert([a,a]==[b,b],true);
assert(a==c,false);
assert(a==d,false);
c.x := [1,2,3];
assert(a==c,true);
c.x := [1,2];
assert(a==c,false);
c.x := a.x;
assert(a==c,true);
assert([a,a]==[b],false);
assert([a,a][]==[b][],true);
